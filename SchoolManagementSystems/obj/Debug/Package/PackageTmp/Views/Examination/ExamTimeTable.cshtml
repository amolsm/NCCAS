@model Entity.Examinationviewmodel
@{
    ViewBag.Title = "ExamTimeTable";
    Layout = "~/Views/shared/_SharedLayout.cshtml";
}
<script src="../../Scripts/jquery-1.10.2.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-ui.js" type="text/javascript"></script>
<style type="text/css">
    .ui-datepicker-calendar {
        background-color: antiquewhite;
    }

    .ui-datepicker-title {
        background-color: antiquewhite;
    }

    .ui-icon ui-icon-circle-triangle-w {
        background-color: antiquewhite;
    }
</style>
<script type="text/javascript">

    $(document).ready(function () {
        FillPermission();
        $("#insert").click(function (e) {
            Validations(e);
        });


        $('#datepicker').attr("readonly", true);

        $('#datepicker').datepicker({
            inline: true,
            showOtherMonths: true,
            showOtherYears: true,
            dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
            dateFormat: 'mm/dd/yy',
            changeMonth: true,
            yearRange: "-100:+0",
            changeYear: true
        });

        //        if ($("#datepicker").val() == "01/01/0001 12:00:00 AM")
        //            $('#datepicker').datepicker('setDate', new Date());
        $('#datepicker').datepicker('setDate', new Date());

        $('#ui-datepicker-div').hide();

        $('#StaffAbsent').change(function () {
            if ($(this).is(":checked")) {
                $('#staffreason').css('display', 'block');
            }
            else {
                $('#staffreason').css('display', 'none');
            }
        });



        function Validations(e) {
            var cnt = 0;
            if ($("#ExaminationName").val() == '') {
                cnt++;
                $("#ExaminationName").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExaminationName").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamDate").val() == '') {
                cnt++;
                $("#ExamDate").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamDate").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamStartTime").val() == '') {
                cnt++;
                $("#ExamStartTime").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamStartTime").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamEndTime").val() == '') {
                cnt++;
                $("#ExamEndTime").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamEndTime").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Classid").val() == '' || $("#Classid").val() == '0') {
                cnt++;
                $("#Classid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Classid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Subjectid").val() == '' || $("#Subjectid").val() == '0') {
                cnt++;
                $("#Subjectid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Subjectid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExaminationTypeid").val() == '' || $("#ExaminationTypeid").val() == '0') {
                cnt++;
                $("#ExaminationTypeid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExaminationTypeid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamYear").val() == '') {
                cnt++;
                $("#ExamYear").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamYear").css({
                    "border": "",
                    "background": ""
                });
            }

            if (cnt != 0) {
                e.preventDefault();
            }
        }


        $("#Classid").change(function () {
            $("#Subjectid").empty();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetSubject")',
                dataType: 'json',
                data: { id: $("#Classid").val() },
                success: function (Subjects) {
                    if (Subjects != "") {
                        var item = '<option value="0">Select Subject</option>';
                        $.each(Subjects, function (i, subject) {
                            item += '<option value="' + subject.Value + '">' + subject.Text + '</option>';
                        });
                        $("#Subjectid").append(item);
                    }
                    else {
                        var item = '<option value="0">select Subject</option>';
                        $("#Subjectid").append(item);
                    }
                },
                error: function (ex) {
                    alert('Failed to retrieve subjects.' + ex);
                }
            });
            return false;
        })

        if ($("#hdyear").val() != "") {
            $("#ExamYear").val($("#hdyear").val());
        }
    });
</script>@Html.Partial("_PermissionHiddenFlds")
<div class="container">
    <div class="row">
        <table cellpadding="0" cellspacing="0" style="margin-top: 38px; margin-bottom:90px;">
            <tr>
                <td class ="col-md-2 well blbg" style="margin-top:50px;" valign="top">
                    @Html.Partial("_ExaminationMenuList")
                </td>
                <td class="col-md-9" style=" padding-top: 30px;">
                    <div>
                        <ul class="breadcrumb">
                            <li>@Html.ActionLink("Home", "Login", "Login")</li>
                            <li>@Html.ActionLink("Examination Management", "Index", "Attendance", "")</li>
                            <li class="active">Exam Time Table</li>
                        </ul>

                        <div class="col-md-10" style="width:100%;">
                            <center>
                                <!-- table start -->
                                <table width="100%">
                                    <tr>
                                        <td>
<div id="AddForm" style="display: none;">
                                            @using (Html.BeginForm("SubmitExam", "Examination", FormMethod.Post, new { enctype = "multipart/form-data", id = "frm", @class = "form-inline" }))
                                            {
                                                @Html.ValidationSummary(true)
                                                <div class="form-group col-md-9">
                                                    @TempData["ErrorMessage"]
                                                </div>
                                                <div style="display: none;" class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.Examid, new { @class = "col-md-6 form_out" })
                                                    @Html.TextBoxFor(model => model.Examid, new { id = "ExaminationName", @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.Examid)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.ExaminationName, new { @class = "col-md-6 form_out" })
                                                    @Html.TextBoxFor(model => model.ExaminationName, new { id = "ExaminationName", @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.ExaminationName)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.ExamDate, new { @class = "col-md-6 form_out" })
                                                    @Html.TextBoxFor(model => model.ExamDate, new { id = "datepicker", placeholder = "Select Date of Exam", @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.ExamDate)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.ExamStartTime, new { @class = "col-md-6 form_out" })
                                                    @Html.TextBoxFor(model => model.ExamStartTime, new { id = "ExamStartTime", @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.ExamStartTime)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.ExamEndTime, new { @class = "col-md-6 form_out" })
                                                    @Html.TextBoxFor(model => model.ExamEndTime, new { id = "ExamEndTime", @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.ExamEndTime)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.ExaminationTypeid, new { @class = "col-md-6 form_out" })
                                                    @Html.DropDownListFor(model => model.ExaminationTypeid, new SelectList(Model.ExaminationTypeList, "ExaminationTypeId", "ExaminationType", "Select Examination Type"), "Select Examination Type", new { @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.Classid)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.Classid, new { @class = "col-md-6 form_out" })
                                                    @Html.DropDownListFor(model => model.Classid, new SelectList(Model.Classlist, "Classid", "Classnm", "Select Class"), "Select Class", new { @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.Classid)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.Subjectid, new { @class = "col-md-6 form_out" })
                                                    @Html.DropDownListFor(model => model.Subjectid, new SelectList(Model.SubjectList, "Subjectid", "SubjectNm", "Select Subject"), "Select Subject", new { @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.Classid)
                                                </div>
                                                <div class="form-group col-md-9">
                                                    @Html.LabelFor(model => model.ExamYear, new { @class = "col-md-6 form_out" })
                                                    @*@Html.TextBoxFor(model => model.ExamYear, new { id = "ExamYear", @class = "col-md-5 form-control form_in" })*@
                                                    @Html.Hidden("hdyear",ViewData["yr"])
                                                    @Html.DropDownListFor(m => m.ExamYear, new SelectList(Model.ExamYear), "Select Year", new { @class = "col-md-5 form-control form_in" })
                                                    @Html.ValidationMessageFor(model => model.ExamYear)
                                                </div>
                                                <div class="form-group col-md-9" style="text-align:center;">
                                                    <input type="submit" action="insert" class="btn btn-primary" id="insert" value="Submit" />
                                                </div>
                                                <div class="form-group col-md-9">
                                                    &nbsp;
                                                </div>
                                            }</div>
                                        </td>
                                    </tr>
                                </table>
                                <!-- table end -->
                            </center>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
        
    </div>
</div>
