@model Entity.employeeviewmodel
@{
    ViewBag.Title = "Employee Master";
    Layout = "~/Views/shared/_SharedLayout.cshtml";
}
<script src="../../Scripts/jquery-1.10.2.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-ui.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        FillPermission();
        FillType();
        function FillType() {
            var item = '<option value="">select Type</option>';
            item += '<option value="4">Teacher</option>';
            item += '<option value="5">Employee</option>';
            $("#Typeid").append(item);
        }
        $("#lblmsg").text('');
        $('#empid input').attr("readonly", true);
        if ($("#empid input").val() == "0") {
            $("#empid").hide();
        }

        $("#result").on("click", ".edit", function (evt) {
            var Empid = this.id;
            $.ajax({
                type: 'GET',
                url: '@Url.Action("FillEmpDetails")',
                dataType: 'JSON',
                data: { Empid: Empid },
                success: function (data) {
                    $("#empid").show();
                    $("#empid input").val(data.Empid);
                    $("#FirstName").val(data.FirstName);
                    $("#MiddleName").val(data.MiddleName);
                    $("#LastName").val(data.LastName);
                    var value = new Date(parseInt(data.DOB.substr(6)));
                    $('#datepicker').datepicker('setDate', value);
                    $('#datepicker').focus();
                    if (data.DateOfJoin != null) {
                        var value1 = new Date(parseInt(data.DateOfJoin.substr(6)));
                        $('#datepicker1').datepicker('setDate', value1);
                    }
                    else {
                        $('#datepicker1').datepicker('setDate', new Date());
                    }

                    $("#Emailid").val(data.Emailid);
                    if (data.Gender == 1) {
                        $("#male").prop("checked", "checked");
                    }
                    else {
                        $("#female").prop("checked", "checked");
                    }
                    $("#Quallification").val(data.Quallification);
                    $("#OQualification").val(data.OtherQualification);
                    $("#Address").val(data.Address);
                    $("#PhoneNo").val(data.PhoneNo);
                    $("#MobileNo").val(data.MobileNo);
                    $("#Code").val(data.Code);
                    $("#Typeid").val(data.Typeid)
                    $("#Zipcode").val(data.Zipcode)
                    $("#Stateid").val(data.Stateid);
                    $("#Cityid").empty();
                    $.ajax({
                        type: 'POST',
                        url: '@Url.Action("GetCities")',
                        dataType: 'json',
                        data: { id: data.Stateid },
                        success: function (cities) {
                            if (cities != "") {
                                var item = '<option value="0">Select city</option>';
                                $.each(cities, function (i, city) {
                                    item += '<option value="' + city.Value + '">' + city.Text + '</option>';
                                });
                                $("#Cityid").append(item);
                                $("#Cityid").val(data.Cityid);
                            }
                            else {
                                var item = '<option value="">Select city</option>';
                                $("#Cityid").append(item);
                            }
                        },
                        error: function (ex) {
                            alert('Failed to retrieve cities.' + ex);
                        }
                    });
                }
            });
        });
        $('#datepicker').attr("readonly", true);

        $('#datepicker').datepicker({
            inline: true,
            showOtherMonths: true,
            showOtherYears: true,
            dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
            dateFormat: 'mm/dd/yy',
            changeMonth: true,
            yearRange: "-100:+0",
            changeYear: true
        });

        $('#datepicker1').attr("readonly", true);

        $('#datepicker1').datepicker({
            inline: true,
            showOtherMonths: true,
            showOtherYears: true,
            dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
            dateFormat: 'mm/dd/yy',
            changeMonth: true,
            yearRange: "-100:+0",
            changeYear: true
        });

        $('#datepicker').datepicker('setDate', new Date());
        $('#datepicker1').datepicker('setDate', new Date());
        $('#datepicker').focus();

        $("#insert").click(function () {
            Validations();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("DMLEmp")',
                data: $('#frm').serialize() + "&evt=submit&id=0",
                success: function (result) {
                    $("#lblmsg").text("Employee Info updated successfully!..");
                    $("#lblmsg").css({ "color": "lime" });
                    $("#lblmsg").css({ "font-size": "25px" });
                    $("#result").html(result);
                    clear();
                    ReloadPaging();
                }
            });
        });

        $("#reset").click(function () {
            clear();
        });

        $("#result").on("click", ".delete", function (evt) {
            var Cityid = this.id;
            var flag = confirm('Are you sure you want to delete this Employee?');
            if (flag) {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("DMLEmp")',
                    data: $('#frm').serialize() + "&evt=Delete&id=" + Cityid + "",
                    success: function (result) {
                        $("#lblmsg").text("Employee deleted successfully!..");
                        $("#lblmsg").css({ "color": "orange" });
                        $("#lblmsg").css({ "font-size": "25px" });
                        $("#result").html(result);
                        clear();
                        ReloadPaging();
                    }
                });
            }
        });

        function clear() {
            $("#empid").hide();
            $('#empid input').val('0');
            $("#FirstName").val('');
            $("#MiddleName").val('');
            $("#LastName").val('');
            $("#Stateid").val('');
            $("#Cityid").val('0');
            $("#Zipcode").val('');
            $("#Emailid").val('');
            $("#PhoneNo").val('');
            $("#MobileNo").val('');
            $("#Code").val('');
            $("#Address").val('');
            $("#Quallification").val('');
            $("#OQualification").val('');
            $("#Typeid").val('');
            $('#datepicker').datepicker('setDate', new Date());
            $('#datepicker1').datepicker('setDate', new Date());
        }

        function Validations(e) {
            var cnt = 0;
            if ($("#FirstName").val() == '') {
                cnt++;
                $("#FirstName").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#FirstName").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#MiddleName").val() == '') {
                cnt++;
                $("#MiddleName").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#MiddleName").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#LastName").val() == '') {
                cnt++;
                $("#LastName").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#LastName").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#datepicker").val() == '') {
                cnt++;
                $("#datepicker").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#datepicker").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#datepicker1").val() == '') {
                cnt++;
                $("#datepicker1").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#datepicker1").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Emailid").val() == '') {
                cnt++;
                $("#Emailid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Emailid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Quallification").val() == '') {
                cnt++;
                $("#Quallification").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Quallification").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Address").val() == '') {
                cnt++;
                $("#Address").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Address").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Zipcode").val() == '') {
                cnt++;
                $("#Zipcode").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Zipcode").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#PhoneNo").val() == '') {
                cnt++;
                $("#PhoneNo").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#PhoneNo").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#MobileNo").val() == '') {
                cnt++;
                $("#MobileNo").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#MobileNo").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Code").val() == '') {
                cnt++;
                $("#Code").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Code").css({
                    "border": "",
                    "background": ""
                });
            }


            if ($("#Stateid").val() == '' || $("#Stateid").val() == '0') {
                cnt++;
                $("#Stateid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Stateid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Cityid").val() == '' || $("#Cityid").val() == '0') {
                cnt++;
                $("#Cityid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Cityid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Typeid").val() == '' || $("#Typeid").val() == '0') {
                cnt++;
                $("#Typeid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Typeid").css({
                    "border": "",
                    "background": ""
                });
            }


            if (cnt != 0) {
                e.preventDefault();
            }
        }

        $("#Stateid").change(function () {
            $("#Cityid").empty();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetCities")',
                dataType: 'json',
                data: { id: $("#Stateid").val() },
                success: function (cities) {
                    if (cities != "") {
                        var item = '<option value="0">select City</option>';
                        $.each(cities, function (i, city) {
                            item += '<option value="' + city.Value + '">' + city.Text + '</option>';
                        });
                        $("#Cityid").append(item);
                    }
                    else {
                        var item = '<option value="0">select City</option>';
                        $("#Cityid").append(item);
                    }
                },
                error: function (ex) {
                    alert('Failed to retrieve cities.' + ex);
                }
            });
            return false;
        })

        $('#Emailid').change(function () {
            $("#lblmsg").text("");
            var Emailid = $('#Emailid').val();
            $.ajax({
                type: 'GET',
                url: '@Url.Action("check_duplicate_Emp")',
                dataType: 'JSON',
                data: { Emailid: Emailid },
                success: function (data) {
                    if (data.Emailid != null) {
                        alert("Emailid Already Exists!..");
                        $("#lblmsg").css({ "color": "orange" });
                        $("#lblmsg").css({ "font-size": "25px" });
                        $('#Emailid').val('');
                        return false;
                    }
                }
            });
        });

        $("#PhoneNo").keypress(function (e) {
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });

        $("#Zipcode").keypress(function (e) {
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });

        $("#MobileNo").keypress(function (e) {
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });

        $("#Code").keypress(function (e) {
            if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });

        function ValidateEmail(email) {
            var expr = /^([\w-\.]+)@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
            return expr.test(email);
        };

        $('#Emailid').blur(function () {
            if (!ValidateEmail($("#Emailid").val())) {
                $("#Emailid").css({
                    "border": "1px solid red"
                });
                $('#Emailid').val('');
                alert("Email address is invalid!..");
                return false;
            }
            else {
                $("#Emailid").css({
                    "border": "",
                    "background": ""
                });
            }
        });

        ReloadPaging();
    });
</script>
<style type="text/css">
    .ui-datepicker-calendar {
        background-color: antiquewhite;
    }

    .ui-datepicker-title {
        background-color: antiquewhite;
    }

    .ui-icon ui-icon-circle-triangle-w {
        background-color: antiquewhite;
    }
</style>@Html.Partial("_PermissionHiddenFlds")
<div class="container">
    <div class="row">

        <div class="col-md-2 well blbg" style="margin-top:38px;">
            @Html.Partial("_MasterSubMenu")
        </div>
        <div class="col-md-9" style="padding-top: 75px;margin-bottom: 90px;">
            <ul class="breadcrumb">
                <li>@Html.ActionLink("Home", "Login", "Login")</li>
                <li>@Html.ActionLink("Masters", "Employee", "Masters", "")</li>
                <li class="active">Employee Master</li>
                <div style="float:right; ">
                    @using (Html.BeginForm())
                    {

                        @Html.TextBox("Search_Data", ViewBag.CurrentFilter as string)
                        <input type="submit" value="Find" />
                    }
                </div>
            </ul>

            <div class="col-md-10" style="width:100%;">
                <center>
                    <table width="100%">
                        <tr>
                            <td>
                                <div id="AddForm" style="display: none;">
                                    @using (Html.BeginForm("", "", FormMethod.Post, new { enctype = "multipart/form-data", id = "frm", @class = "form-inline" }))
                                    {
                                        @Html.ValidationSummary(true)
                                        var fromdt = Convert.ToString(System.DateTime.Now.Year);
                                        var todt = Convert.ToString(System.DateTime.Now.AddYears(1).Year);
                                        var session = Convert.ToString(fromdt + "-" + todt);
                                        <div align="center" id="lblmsg">
                                        </div>
                                        <div id="tabs-1">
                                            <div id="empid">
                                                <div class="form-group col-xs-3">
                                                    @Html.LabelFor(model => model.Empid, new { @class = "maru-size" })
                                                </div>
                                                <div class="form-group col-xs-3">
                                                    @Html.TextBoxFor(model => model.Empid, new { placeholder = "Enter Employee ID", @class = "form-control mar" })
                                                    @Html.ValidationMessageFor(model => model.Empid)
                                                </div>
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.FirstName, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.FirstName, new { placeholder = "Enter First Name", maxlength = "20", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.FirstName)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.MiddleName, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.MiddleName, new { placeholder = "Enter Middle Name", maxlength = "20", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.MiddleName)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.LastName, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.LastName, new { placeholder = "Enter Last Name", maxlength = "20", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.LastName)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.DOB, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.DOB, new { id = "datepicker", placeholder = "Select Date of birth", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.DOB)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Stateid, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.DropDownListFor(m => m.Stateid, new SelectList(Model.statelist, "Stateid", "StateName", "Select State"), "Select state", new { @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.Stateid)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Cityid, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.DropDownListFor(m => m.Cityid, new SelectList(Model.citylist, "Cityid", "CityName", "Select City"), "Select city", new { @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.Cityid)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Zipcode, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.Zipcode, new { placeholder = "Enter Zipcode", maxlength = "6", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.Zipcode)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Emailid, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.Emailid, new { placeholder = "Enter Email", maxlength = "30", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.Emailid)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.PhoneNo, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.PhoneNo, new { placeholder = "Enter Phone Number", maxlength = "12", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.PhoneNo)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.MobileNo, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.Code, new { placeholder = "Code", maxlength = "4", @class = "form-control mar", @Style="width:30%" })
                                                @Html.TextBoxFor(model => model.MobileNo, new { placeholder = "Mobile Number", maxlength = "10", @Style="width:63%", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.MobileNo)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Address, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextAreaFor(model => model.Address, new { placeholder = "Enter Address", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.Address)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Gender, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3" style="height:35px;">
                                                <div class="pull-left">
                                                    @Html.RadioButtonFor(model => model.Gender, "true", new { id = "male" })
                                                    Male
                                                    @Html.RadioButtonFor(model => model.Gender, "false", new { id = "female" }) FeMale
                                                </div>
                                                @Html.ValidationMessageFor(model => model.Gender)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Quallification, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.DropDownListFor(m => m.Quallification, new SelectList(Model.qualificationlist, "qualificationid", "qualificationnm", "Select Qualification"), "Select Qualification", new { @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.Quallification)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.DateOfJoin, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextBoxFor(model => model.DateOfJoin, new { id = "datepicker1", placeholder = "Select Joining Date", @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.DateOfJoin)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.Typeid, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                <select id="Typeid" class="form-control mar" name="Typeid"></select>
                                                @Html.ValidationMessageFor(model => model.Typeid)
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.LabelFor(model => model.OQualification, new { @class = "maru-size" })
                                            </div>
                                            <div class="form-group col-xs-3">
                                                @Html.TextAreaFor(model => model.OQualification, new { @class = "form-control mar" })
                                                @Html.ValidationMessageFor(model => model.OQualification)
                                            </div>
                                            <div class="form-group col-md-9" style="text-align:center;">
                                                <input type="button" class="btn btn-primary" id="insert" value="Submit" />
                                                <input type="button" class="btn btn-primary" id="reset" value="Reset" />
                                            </div>
                                        </div>
                                    }
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <br />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div>
                                    <div class="" style=" color:#23527c">
                                        @Html.Partial("_EmpList")
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                    @*<div id="pager" class="col-md-4 col-md-offset-8" style="position: none;">
                            <img src="../../Content/images/first.png" style="width:19px;" class="first" />
                            <img src="../../Content/images/prev.png" style="width:19px;" class="prev" />
                            <input type="text" style="width:50px;" disabled="disabled" class="pagedisplay" />
                            <img src="../../Content/images/next.png" style="width:19px;" class="next" />
                            <img src="../../Content/images/last.png" style="width:19px;" class="last" />
                            <select style="border-color:Blue;" class="pagesize">
                                <option selected="selected" value="10">10</option>
                                <option value="15">15</option>
                                <option value="20">20</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                        </div>*@
                </center>
            </div>
        </div>
    </div>
</div>
