@model Entity.Examinationviewmodel
@{
    ViewBag.Title = "ExamTimeTable";
    Layout = "~/Views/shared/_SharedLayout.cshtml";
}
<script src="../../Scripts/jquery-1.10.2.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-ui.js" type="text/javascript"></script>
<style type="text/css">
    .ui-datepicker-calendar {
        background-color: antiquewhite;
    }

    .ui-datepicker-title {
        background-color: antiquewhite;
    }

    .ui-icon ui-icon-circle-triangle-w {
        background-color: antiquewhite;
    }
</style>
<script type="text/javascript">

    $(document).ready(function () {
        FillPermission();
        $("#insert").click(function (e) {
            Validations(e);
            $.ajax({
                type: 'POST',
                url: '@Url.Action("SubmitExam")',
                data: $('#frm').serialize() + "&evt=submit",
                success: function (result) {
                    $("#msgs").show();
                    $("#lblmsgs").text("Exam Time table  updated successfully!..");
                    $("#lblmsgs").css({ "color": "green" });
                    $("#lblmsgs").css({ "font-size": "15px" });
                    $("#result").html(result);
                    clear();

                    ReloadPaging();
                }
                });
        });


        $('#datepicker').attr("readonly", true);

        $('#datepicker').datepicker({
            inline: true,
            showOtherMonths: true,
            showOtherYears: true,
            dayNamesMin: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
            dateFormat: 'mm/dd/yy',
            changeMonth: true,
            yearRange: "-100:+0",
            changeYear: true
        });

        //        if ($("#datepicker").val() == "01/01/0001 12:00:00 AM")
        //            $('#datepicker').datepicker('setDate', new Date());
        $('#datepicker').datepicker('setDate', new Date());

        $('#ui-datepicker-div').hide();

        $('#StaffAbsent').change(function () {
            if ($(this).is(":checked")) {
                $('#staffreason').css('display', 'block');
            }
            else {
                $('#staffreason').css('display', 'none');
            }
        });



        function Validations(e) {
            var cnt = 0;
            if ($("#ExaminationName").val() == '') {
                cnt++;
                $("#ExaminationName").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExaminationName").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamDate").val() == '') {
                cnt++;
                $("#ExamDate").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamDate").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamStartTime").val() == '') {
                cnt++;
                $("#ExamStartTime").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamStartTime").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamEndTime").val() == '') {
                cnt++;
                $("#ExamEndTime").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamEndTime").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Classid").val() == '' || $("#Classid").val() == '0') {
                cnt++;
                $("#Classid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Classid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#Subjectid").val() == '' || $("#Subjectid").val() == '0') {
                cnt++;
                $("#Subjectid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#Subjectid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExaminationTypeid").val() == '' || $("#ExaminationTypeid").val() == '0') {
                cnt++;
                $("#ExaminationTypeid").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExaminationTypeid").css({
                    "border": "",
                    "background": ""
                });
            }

            if ($("#ExamYear").val() == '') {
                cnt++;
                $("#ExamYear").css({
                    "border": "1px solid red"
                });
            }
            else {
                $("#ExamYear").css({
                    "border": "",
                    "background": ""
                });
            }

            if (cnt != 0) {
                e.preventDefault();
            }
        }


        $("#Classid").change(function () {
            $("#Subjectid").empty();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetSubject")',
                dataType: 'json',
                data: { id: $("#Classid").val() },
                success: function (Subjects) {
                    if (Subjects != "") {
                        var item = '<option value="0">Select Subject</option>';
                        $.each(Subjects, function (i, subject) {
                            item += '<option value="' + subject.Value + '">' + subject.Text + '</option>';
                        });
                        $("#Subjectid").append(item);
                    }
                    else {
                        var item = '<option value="0">select Subject</option>';
                        $("#Subjectid").append(item);
                    }
                },
                error: function (ex) {
                    alert('Failed to retrieve subjects.' + ex);
                }
            });
            return false;
        })

        if ($("#hdyear").val() != "") {
            $("#ExamYear").val($("#hdyear").val());
        }
    });
</script>@Html.Partial("_PermissionHiddenFlds")
<div class="container-fluid-full">
             
		<div class="row-fluid">
              @Html.Partial("_ExaminationMenuList")
	<div id="content" class="span10">
        	<div class="row-fluid">
                
           
             
              
                        <ul class="breadcrumb">
                             <li><i class="icon-home"></i>@Html.ActionLink("Home", "Login", "Login")<i class="icon-angle-right"></i>
                           @Html.ActionLink("Examination Management", "Index", "Attendance", "")<i class="icon-angle-right"></i></li>
                            <li class="active">Exam Time Table</li>
                        </ul>

                 <div class="panel-body"> 
<div id="msg" hidden="hidden" class="alert alert-warning" visible="false">
	<strong><label id="lblmsg"></label></strong> 
	</div>
  <div id="msgs" hidden="hidden" class="alert alert-success" visible="false">
	<strong><label id="lblmsgs"></label></strong> 
</div>
</div>

                         <div class="row-fluid sortable">
              <div class="box span12">
					<div class="box-header" data-original-title>
						<h2><i class="fa fa-edit"></i><span class="break"></span>Form Elements</h2>
						<div class="box-icon">
						
							<a href="#" class="btn-minimize"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
						
						</div>
					</div>
                               		<div class="box-content">
						<form id="frm" class="form-horizontal">
                              
						
                                  <fieldset>
                                            @using (Html.BeginForm("SubmitExam", "Examination", FormMethod.Post, new { enctype = "multipart/form-data", id = "frm",  @class="form-horizontal" }))
                                            {
                                                @Html.ValidationSummary(true)
                                                <div class="control-group">
                                                    @TempData["ErrorMessage"]
                                                </div>
                                                <div style="display: none;" class="control-group">
                                                    @Html.LabelFor(model => model.Examid, new { @class="control-label" })
                                                       <div class="controls">
                                                    @Html.TextBoxFor(model => model.Examid, new { id = "ExaminationName", @class = "input" })
                                                    @Html.ValidationMessageFor(model => model.Examid)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.ExaminationName, new { @class="control-label"  })
                                                       <div class="controls">
                                                    @Html.TextBoxFor(model => model.ExaminationName, new { id = "ExaminationName", @class = "input" })
                                                    @Html.ValidationMessageFor(model => model.ExaminationName)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.ExamDate, new { @class="control-label"  })
                                                       <div class="controls">
                                                    @Html.TextBoxFor(model => model.ExamDate, new { id = "datepicker", placeholder = "Select Date of Exam",@class="input" })
                                                    @Html.ValidationMessageFor(model => model.ExamDate)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.ExamStartTime, new { @class="control-label"  })
                                                       <div class="controls">
                                                    @Html.TextBoxFor(model => model.ExamStartTime, new { id = "ExamStartTime", @class="input" })
                                                    @Html.ValidationMessageFor(model => model.ExamStartTime)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.ExamEndTime, new { @class="control-label"  })
                                                       <div class="controls">
                                                    @Html.TextBoxFor(model => model.ExamEndTime, new { id = "ExamEndTime", @class="input" })
                                                    @Html.ValidationMessageFor(model => model.ExamEndTime)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.ExaminationTypeid, new { @class="control-label",@for="select"  })
                                                       <div class="controls">
                                                    @Html.DropDownListFor(model => model.ExaminationTypeid, new SelectList(Model.ExaminationTypeList, "ExaminationTypeId", "ExaminationType", "Select Examination Type"), "Select Examination Type", new { @for="select" })
                                                    @Html.ValidationMessageFor(model => model.Classid)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.Classid, new {@class="control-label"  })
                                                       <div class="controls">
                                                    @Html.DropDownListFor(model => model.Classid, new SelectList(Model.Classlist, "Classid", "Classnm", "Select Class"), "Select Class", new { @for="select" })
                                                    @Html.ValidationMessageFor(model => model.Classid)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.Subjectid, new { @class="control-label",@for="select"  })
                                                       <div class="controls">
                                                    @Html.DropDownListFor(model => model.Subjectid, new SelectList(Model.SubjectList, "Subjectid", "SubjectNm", "Select Subject"), "Select Subject", new { @for="select" })
                                                    @Html.ValidationMessageFor(model => model.Classid)
                                                           </div>
                                                </div>
                                                <div class="control-group">
                                                    @Html.LabelFor(model => model.ExamYear, new { @class="control-label",@for="select"  })
                                                     <div class="controls">
                                                    @*@Html.TextBoxFor(model => model.ExamYear, new { id = "ExamYear", @class = "col-md-5 form-control form_in" })*@
                                                    @Html.Hidden("hdyear",ViewData["yr"])
                                                    @Html.DropDownListFor(m => m.ExamYear, new SelectList(Model.ExamYear), "Select Year", new { @for="select" })
                                                    @Html.ValidationMessageFor(model => model.ExamYear)
                                                </div>
                                                    </div>
                                                <div class="form-actions">
                                                    <input type="submit" action="insert" class="btn btn-primary" id="insert" value="Submit" />
                                                </div>
                                                <div class="control-group">
                                                    &nbsp;
                                                </div>
                                            }  </fieldset>
                                </form>
					
					</div>
				</div><!--/span-->
			
			</div><!--/row-->
                </div>
        </div>
            </div>
    </div>
